---
title: 基于卡曼滤波器的模型
---

## 基于卡曼滤波器的模型

[The extended Kalman filter for continuous glucose monitoring](https://doi.org/10.1089/dia.2005.7.15)

该方法建立血糖、组织液葡萄糖以及其他参数的卡曼滤波器模型，输入用于校准血糖值后，算法可以结合测得的电信号，连续输出预测的血糖信号。

## 卡曼滤波器

扩展卡尔曼滤波器（Extended Kalman Filter，简称EKF）是一种用于估计非线性系统状态的算法。它是卡尔曼滤波器的扩展，用于处理系统模型和观测模型都是非线性的情况。EKF通过线性化非线性模型来近似卡尔曼滤波器的计算，使其能够应用于更广泛的动态系统。

扩展卡尔曼滤波器（EKF）的工作原理主要包括以下几个步骤：

1. **非线性函数的线性化**：EKF首先对非线性系统进行线性化处理，这通常是通过泰勒级数展开来实现的，只保留一阶导数项（舍去二阶及以上项），从而得到一个近似的线性化模型。

2. **构建线性化模型**：将非线性函数围绕滤波值展开成泰勒级数，并略去二阶及以上项，得到一个近似的线性化模型。

3. **预测（Predict）步骤**：根据系统动态模型，预测下一时刻的状态向量。这涉及到状态转移和观测矩阵的雅可比矩阵的计算，这些雅可比矩阵代替了卡尔曼滤波中的线性模型中的状态转移矩阵和观测矩阵。

4. **更新（Update）步骤**：根据观测数据，计算卡尔曼增益，并更新状态向量。这个步骤涉及到计算实际传感器测量值和预测传感器测量值之间的差异，然后利用这个差异来更新状态估计。

5. **卡尔曼增益的计算**：在更新步骤中，计算卡尔曼增益，它是预测误差协方差和观测模型误差协方差的函数，用于确定预测状态和观测数据在最终状态估计中的权重。

6. **迭代过程**：在某些情况下，EKF会进行迭代，以提高估计的准确性。这个过程涉及到在每次迭代中更新状态估计和卡尔曼增益，直到连续两次迭代之间的改进变得非常小。

7. **稳定性和误差控制**：EKF的设计确保了在一定的条件下，估计误差保持有界，这涉及到过程噪声和观测噪声的协方差矩阵的性质。

EKF通过这种方式，将非线性问题转化为线性问题，然后利用卡尔曼滤波器的优势进行状态估计和滤波，从而在存在非线性因素的系统中提供精确的状态估计。

## 局限性

该模型的许多参数并不能直接从数据中习得，需要人为预估，随意性较大。

## 实现

`EKF.py`实现了卡曼滤波器模型，该模型运行长时间后，逆推值的偏移严重，且对预设参数极为敏感。因为模型稳定性的原因，没有继续验证模型结果和准确率。